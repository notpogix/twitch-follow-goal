<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Twitch Follower Goal</title>
  <style>
    body {
      margin: 0;
      background: transparent;
    }
    #goal {
      color: #fff;
      font-family: Arial, Helvetica, sans-serif;
      font-size: 32px;
      text-shadow: 0 0 4px rgba(0,0,0,0.7);
      background: transparent;
    }
  </style>
</head>
<body>
  <div id="goal">Followers: ...</div>
  <script>
    // Parse username and goal from URL parameters
    function getQuery(q, def) {
      let url = new URL(window.location.href);
      return url.searchParams.get(q) || def;
    }
    const username = getQuery("user", "twitch"); // change default user if you want
    let goal = parseInt(getQuery("goal", "200"), 10);

    // Get Twitch user ID from username
    async function getUserID(name) {
      const res = await fetch(`https://api.twitch.tv/helix/users?login=${name}`, {
        headers: {
          "Client-ID": "kimne78kx3ncx6brgo4mv6wki5h1ko", // public client id used for overlays
          "Accept": "application/json"
        }
      });
      const data = await res.json();
      return data.data && data.data.length ? data.data[0].id : null;
    }

    // Get followers count for user id
    async function getFollowerCount(userId) {
      const res = await fetch(`https://api.twitch.tv/helix/users/follows?to_id=${userId}`, {
        headers: {
          "Client-ID": "kimne78kx3ncx6brgo4mv6wki5h1ko",
          "Accept": "application/json"
        }
      });
      const data = await res.json();
      return data.total || 0;
    }

    async function updateGoal() {
      const el = document.getElementById("goal");
      el.textContent = "Loading...";
      let userId = await getUserID(username);
      if (!userId) {
        el.textContent = "User not found";
        return;
      }
      let count = await getFollowerCount(userId);
      el.textContent = `Followers: ${count}/${goal}`;
    }

    updateGoal();
    setInterval(updateGoal, 60000); // update every 1 minute
  </script>
</body>
</html>
